<?php
// Start a new session
session_start();
if (isset($_SESSION['email'])) {
    header("Location: ./dashboard.php");
    exit;
}

include '../config/config.php';
$error = null; // Initialize the error variable

if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['submit'])) {
    $email = filter_input(INPUT_POST, 'email', FILTER_SANITIZE_EMAIL);
    $password = filter_input(INPUT_POST, 'password', FILTER_SANITIZE_FULL_SPECIAL_CHARS);

    if (empty($email) || empty($password)) {
        $error = "*** Please fill in all fields. ***"; // Set the error message
    } else {
        $query = "SELECT * FROM tbstudinfo WHERE email = ?";
        $stmt = mysqli_prepare($conn, $query);

        if ($stmt) {
            mysqli_stmt_bind_param($stmt, 's', $email);
            mysqli_stmt_execute($stmt);
            $result = mysqli_stmt_get_result($stmt);
            $row = mysqli_fetch_assoc($result);

            // Directly compare the passwords (constbstudinfoer using password hashing in production)
            if ($row && $row['password'] === $password) {
                // Set session variables
                $_SESSION['email'] = $row['email'];
                $_SESSION['admin_name'] = $row['admin_name'];
                // Redirect to dashboard
                header("Location: ./dashboard.php");
                exit;
            } else {
                $error = "*** Invaltbstudinfo Login Credentials. ***"; // Set the error message
            }
        } else {
            $error = "Failed to prepare the statement: " . mysqli_error($conn); // Set the error message
        }
    }
}
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="wtbstudinfoth=device-wtbstudinfoth, initial-scale=1.0">
    <title>Admin Portal</title>
    <link rel="stylesheet" href="../styles/auth.css">
</head>

<body>
    <main>
        <section class="first-section">
            <div class="header">
                <svg xmlns="http://www.w3.org/2000/svg" wtbstudinfoth="38" height="38" viewBox="0 0 38 38" fill="none">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M9.60564 6.13365C8.49306 6.00931 7.3404 6.00931 6.22781 6.13365C6.20715 6.13596 6.18671 6.14532 6.1699 6.16188C6.15349 6.17806 6.14709 6.19441 6.14546 6.20829C6.01271 7.34334 6.01271 8.48999 6.14546 9.62504C6.14709 9.63892 6.15349 9.65527 6.1699 9.67145C6.18671 9.68802 6.20715 9.69737 6.22781 9.69968C7.3404 9.82403 8.49306 9.82403 9.60564 9.69968C9.62631 9.69737 9.64675 9.68802 9.66355 9.67145C9.67996 9.65527 9.68637 9.63892 9.68799 9.62504C9.82074 8.48999 9.82074 7.34334 9.68799 6.20829C9.68637 6.19441 9.67996 6.17806 9.66355 6.16188C9.64675 6.14532 9.62631 6.13596 9.60564 6.13365ZM5.96402 3.77335C7.25192 3.62941 8.58154 3.62941 9.86944 3.77335C10.9973 3.8994 11.9129 4.78676 12.0469 5.9324C12.2011 7.25075 12.2011 8.58258 12.0469 9.90094C11.9129 11.0466 10.9973 11.9339 9.86944 12.06C8.58154 12.2039 7.25192 12.2039 5.96402 12.06C4.83617 11.9339 3.92054 11.0466 3.78654 9.90094C3.63235 8.58258 3.63235 7.25075 3.78654 5.9324C3.92054 4.78676 4.83617 3.8994 5.96402 3.77335Z"
                        fill="url(#paint0_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M20.689 6.13365C19.5764 6.00931 18.4237 6.00931 17.3111 6.13365C17.2905 6.13596 17.27 6.14532 17.2532 6.16188C17.2368 6.17806 17.2304 6.19441 17.2288 6.20829C17.096 7.34334 17.096 8.48999 17.2288 9.62504C17.2304 9.63892 17.2368 9.65527 17.2532 9.67145C17.27 9.68802 17.2905 9.69737 17.3111 9.69968C18.4237 9.82403 19.5764 9.82403 20.689 9.69968C20.7096 9.69737 20.7301 9.68802 20.7469 9.67145C20.7633 9.65527 20.7697 9.63892 20.7713 9.62504C20.9041 8.48999 20.9041 7.34334 20.7713 6.20829C20.7697 6.19441 20.7633 6.17806 20.7469 6.16188C20.7301 6.14532 20.7096 6.13596 20.689 6.13365ZM17.0473 3.77335C18.3353 3.62941 19.6649 3.62941 20.9528 3.77335C22.0806 3.8994 22.9963 4.78676 23.1302 5.9324C23.2844 7.25075 23.2844 8.58258 23.1302 9.90094C22.9963 11.0466 22.0806 11.9339 20.9528 12.06C19.6649 12.2039 18.3353 12.2039 17.0473 12.06C15.9195 11.9339 15.0039 11.0466 14.8699 9.90094C14.7157 8.58258 14.7157 7.25075 14.8699 5.9324C15.0039 4.78676 15.9195 3.8994 17.0473 3.77335Z"
                        fill="url(#paint1_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M31.7723 6.13365C30.6597 6.00931 29.5071 6.00931 28.3945 6.13365C28.3738 6.13596 28.3534 6.14532 28.3366 6.16188C28.3202 6.17806 28.3138 6.19441 28.3121 6.20829C28.1794 7.34334 28.1794 8.48999 28.3121 9.62504C28.3138 9.63892 28.3202 9.65527 28.3366 9.67145C28.3534 9.68802 28.3738 9.69737 28.3945 9.69968C29.5071 9.82403 30.6597 9.82403 31.7723 9.69968C31.793 9.69737 31.8134 9.68802 31.8302 9.67145C31.8466 9.65527 31.853 9.63892 31.8547 9.62504C31.9874 8.48999 31.9874 7.34334 31.8547 6.20829C31.853 6.19441 31.8466 6.17806 31.8302 6.16188C31.8134 6.14532 31.793 6.13596 31.7723 6.13365ZM28.1307 3.77335C29.4186 3.62941 30.7482 3.62941 32.0361 3.77335C33.164 3.8994 34.0796 4.78676 34.2136 5.9324C34.3678 7.25075 34.3678 8.58258 34.2136 9.90094C34.0796 11.0466 33.164 11.9339 32.0361 12.06C30.7482 12.2039 29.4186 12.2039 28.1307 12.06C27.0028 11.9339 26.0872 11.0466 25.9532 9.90094C25.799 8.58258 25.799 7.25075 25.9532 5.9324C26.0872 4.78676 27.0028 3.8994 28.1307 3.77335Z"
                        fill="url(#paint2_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M9.60564 17.217C8.49306 17.0926 7.3404 17.0926 6.22781 17.217C6.20715 17.2193 6.18671 17.2287 6.1699 17.2452C6.15349 17.2614 6.14709 17.2777 6.14546 17.2916C6.01271 18.4267 6.01271 19.5733 6.14546 20.7084C6.14709 20.7223 6.15349 20.7386 6.1699 20.7548C6.18671 20.7713 6.20715 20.7807 6.22781 20.783C7.3404 20.9074 8.49306 20.9074 9.60564 20.783C9.62631 20.7807 9.64675 20.7713 9.66355 20.7548C9.67996 20.7386 9.68637 20.7223 9.68799 20.7084C9.82074 19.5733 9.82074 18.4267 9.68799 17.2916C9.68637 17.2777 9.67996 17.2614 9.66355 17.2452C9.64675 17.2287 9.62631 17.2193 9.60564 17.217ZM5.96402 14.8567C7.25192 14.7127 8.58154 14.7127 9.86944 14.8567C10.9973 14.9827 11.9129 15.8701 12.0469 17.0157C12.2011 18.3341 12.2011 19.6659 12.0469 20.9843C11.9129 22.1299 10.9973 23.0173 9.86944 23.1433C8.58154 23.2873 7.25192 23.2873 5.96402 23.1433C4.83617 23.0173 3.92054 22.1299 3.78654 20.9843C3.63235 19.6659 3.63235 18.3341 3.78654 17.0157C3.92054 15.8701 4.83617 14.9827 5.96402 14.8567Z"
                        fill="url(#paint3_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M20.689 17.217C19.5764 17.0926 18.4237 17.0926 17.3111 17.217C17.2905 17.2193 17.27 17.2287 17.2532 17.2452C17.2368 17.2614 17.2304 17.2777 17.2288 17.2916C17.096 18.4267 17.096 19.5733 17.2288 20.7084C17.2304 20.7223 17.2368 20.7386 17.2532 20.7548C17.27 20.7713 17.2905 20.7807 17.3111 20.783C18.4237 20.9074 19.5764 20.9074 20.689 20.783C20.7096 20.7807 20.7301 20.7713 20.7469 20.7548C20.7633 20.7386 20.7697 20.7223 20.7713 20.7084C20.9041 19.5733 20.9041 18.4267 20.7713 17.2916C20.7697 17.2777 20.7633 17.2614 20.7469 17.2452C20.7301 17.2287 20.7096 17.2193 20.689 17.217ZM17.0473 14.8567C18.3353 14.7127 19.6649 14.7127 20.9528 14.8567C22.0806 14.9827 22.9963 15.8701 23.1302 17.0157C23.2844 18.3341 23.2844 19.6659 23.1302 20.9843C22.9963 22.1299 22.0806 23.0173 20.9528 23.1433C19.6649 23.2873 18.3353 23.2873 17.0473 23.1433C15.9195 23.0173 15.0039 22.1299 14.8699 20.9843C14.7157 19.6659 14.7157 18.3341 14.8699 17.0157C15.0039 15.8701 15.9195 14.9827 17.0473 14.8567Z"
                        fill="url(#paint4_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M31.7723 17.217C30.6597 17.0926 29.5071 17.0926 28.3945 17.217C28.3738 17.2193 28.3534 17.2287 28.3366 17.2452C28.3202 17.2614 28.3138 17.2777 28.3121 17.2916C28.1794 18.4267 28.1794 19.5733 28.3121 20.7084C28.3138 20.7223 28.3202 20.7386 28.3366 20.7548C28.3534 20.7713 28.3738 20.7807 28.3945 20.783C29.5071 20.9074 30.6597 20.9074 31.7723 20.783C31.793 20.7807 31.8134 20.7713 31.8302 20.7548C31.8466 20.7386 31.853 20.7223 31.8547 20.7084C31.9874 19.5733 31.9874 18.4267 31.8547 17.2916C31.853 17.2777 31.8466 17.2614 31.8302 17.2452C31.8134 17.2287 31.793 17.2193 31.7723 17.217ZM28.1307 14.8567C29.4186 14.7127 30.7482 14.7127 32.0361 14.8567C33.164 14.9827 34.0796 15.8701 34.2136 17.0157C34.3678 18.3341 34.3678 19.6659 34.2136 20.9843C34.0796 22.1299 33.164 23.0173 32.0361 23.1433C30.7482 23.2873 29.4186 23.2873 28.1307 23.1433C27.0028 23.0173 26.0872 22.1299 25.9532 20.9843C25.799 19.6659 25.799 18.3341 25.9532 17.0157C26.0872 15.8701 27.0028 14.9827 28.1307 14.8567Z"
                        fill="url(#paint5_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M9.60564 28.3003C8.49306 28.176 7.3404 28.176 6.22781 28.3003C6.20715 28.3026 6.18671 28.312 6.1699 28.3285C6.15349 28.3447 6.14709 28.3611 6.14546 28.375C6.01271 29.51 6.01271 30.6567 6.14546 31.7917C6.14709 31.8056 6.15349 31.8219 6.1699 31.8381C6.18671 31.8547 6.20715 31.864 6.22781 31.8663C7.3404 31.9907 8.49306 31.9907 9.60564 31.8663C9.62631 31.864 9.64675 31.8547 9.66355 31.8381C9.67996 31.8219 9.68637 31.8056 9.68799 31.7917C9.82074 30.6567 9.82074 29.51 9.68799 28.375C9.68637 28.3611 9.67996 28.3447 9.66355 28.3285C9.64675 28.312 9.62631 28.3026 9.60564 28.3003ZM5.96402 25.94C7.25192 25.7961 8.58154 25.7961 9.86944 25.94C10.9973 26.0661 11.9129 26.9534 12.0469 28.0991C12.2011 29.4174 12.2011 30.7493 12.0469 32.0676C11.9129 33.2132 10.9973 34.1006 9.86944 34.2267C8.58154 34.3706 7.25192 34.3706 5.96402 34.2267C4.83617 34.1006 3.92054 33.2132 3.78654 32.0676C3.63235 30.7493 3.63235 29.4174 3.78654 28.0991C3.92054 26.9534 4.83617 26.0661 5.96402 25.94Z"
                        fill="url(#paint6_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M20.689 28.3003C19.5764 28.176 18.4237 28.176 17.3111 28.3003C17.2905 28.3026 17.27 28.312 17.2532 28.3285C17.2368 28.3447 17.2304 28.3611 17.2288 28.375C17.096 29.51 17.096 30.6567 17.2288 31.7917C17.2304 31.8056 17.2368 31.8219 17.2532 31.8381C17.27 31.8547 17.2905 31.864 17.3111 31.8663C18.4237 31.9907 19.5764 31.9907 20.689 31.8663C20.7096 31.864 20.7301 31.8547 20.7469 31.8381C20.7633 31.8219 20.7697 31.8056 20.7713 31.7917C20.9041 30.6567 20.9041 29.51 20.7713 28.375C20.7697 28.3611 20.7633 28.3447 20.7469 28.3285C20.7301 28.312 20.7096 28.3026 20.689 28.3003ZM17.0473 25.94C18.3353 25.7961 19.6649 25.7961 20.9528 25.94C22.0806 26.0661 22.9963 26.9534 23.1302 28.0991C23.2844 29.4174 23.2844 30.7493 23.1302 32.0676C22.9963 33.2132 22.0806 34.1006 20.9528 34.2267C19.6649 34.3706 18.3353 34.3706 17.0473 34.2267C15.9195 34.1006 15.0039 33.2132 14.8699 32.0676C14.7157 30.7493 14.7157 29.4174 14.8699 28.0991C15.0039 26.9534 15.9195 26.0661 17.0473 25.94Z"
                        fill="url(#paint7_linear_33_343)" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M31.7723 28.3003C30.6597 28.176 29.5071 28.176 28.3945 28.3003C28.3738 28.3026 28.3534 28.312 28.3366 28.3285C28.3202 28.3447 28.3138 28.3611 28.3121 28.375C28.1794 29.51 28.1794 30.6567 28.3121 31.7917C28.3138 31.8056 28.3202 31.8219 28.3366 31.8381C28.3534 31.8547 28.3738 31.864 28.3945 31.8663C29.5071 31.9907 30.6597 31.9907 31.7723 31.8663C31.793 31.864 31.8134 31.8547 31.8302 31.8381C31.8466 31.8219 31.853 31.8056 31.8547 31.7917C31.9874 30.6567 31.9874 29.51 31.8547 28.375C31.853 28.3611 31.8466 28.3447 31.8302 28.3285C31.8134 28.312 31.793 28.3026 31.7723 28.3003ZM28.1307 25.94C29.4186 25.7961 30.7482 25.7961 32.0361 25.94C33.164 26.0661 34.0796 26.9534 34.2136 28.0991C34.3678 29.4174 34.3678 30.7493 34.2136 32.0676C34.0796 33.2132 33.164 34.1006 32.0361 34.2267C30.7482 34.3706 29.4186 34.3706 28.1307 34.2267C27.0028 34.1006 26.0872 33.2132 25.9532 32.0676C25.799 30.7493 25.799 29.4174 25.9532 28.0991C26.0872 26.9534 27.0028 26.0661 28.1307 25.94Z"
                        fill="url(#paint8_linear_33_343)" />
                    <defs>
                        <linearGradient tbstudinfo="paint0_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint1_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint2_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint3_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint4_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint5_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint6_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint7_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                        <linearGradient tbstudinfo="paint8_linear_33_343" x1="37" y1="6.5" x2="-12" y2="25"
                            gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FF0000" />
                            <stop offset="0.992549" stop-opacity="0" />
                        </linearGradient>
                    </defs>
                </svg>
                <h1>Event Registration</h1>
            </div>
            <div class="box">
                <div class="login-container">
                    <h1>Student Portal</h1>
                    <p>Please enter your contact details to connect.</p>
                    <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="POST">
                        <div class="form-group">
                            <label>Email address</label>
                            <input type="email" name="email" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" name="password" placeholder="Password" required>
                        </div>
                        <div class="error<?php if (!empty($error))
                            echo ' show'; ?>">
                            <?php if (!empty($error)): ?>
                                <p>
                                    <?php echo $error; ?>
                                </p>
                            <?php endif; ?>
                        </div>

                        <button type="submit" name="submit">Sign in</button>
                        <h5>By using this service, you understood and agree to the
                            Event Online Registration BSU Terms of Use and Privacy
                            Statement
                        </h5>
                    </form>
                </div>

            </div>

        </section>
        <section class="second-section">
            <div class="yellow"></div>
            <div class="container">

                <div class="title">
                    <h1>BATANGAS STATE UNIVERSITY</h1>
                    <h3>The National Engineering University</h3>
                    <img src="../images/Batangas_State_Logo.png" alt="Batangas State University Logo">
                </div>
                <div class="welcome-context">
                    <h3>
                        Welcome to the university portal
                    </h3>
                    <span>Lorem ipsum dolor sit amet consectetur adipisicing elit. Eaque enim repudiandae dolorum
                        magnam?
                        Sequi repellendus alias sed nisi tempore.</span>
                </div>
            </div>
        </section>
    </main>
</body>

</html>